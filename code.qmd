---
title: "STA 210 - Final Project"
author: "Zakk Heile & Julia Healey-Parera"
format: pdf
---

```{r}


library(tidyverse)
library(broom)
library(glm2)
library(dplyr)
library(Stat2Data)
library(pROC)
library(yardstick)
library(ggplot2)
library(janitor)
library(here)
library(fs)
library(withr)

#edu <- read.csv("data/english_education.csv")
edu <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-01-23/english_education.csv')



working_dir <- here::here("data")

xls_path <- withr::local_tempfile(fileext = ".xlsx")
download.file(
  "https://www.ons.gov.uk/file?uri=/peoplepopulationandcommunity/educationandchildcare/datasets/educationalattainmentofyoungpeopleinenglishtownsdata/200708201819/youngpeoplesattainmentintownsreferencetable1.xlsx",
  xls_path,
  mode = "wb"
)

english_education <- readxl::read_xlsx(xls_path, sheet = "Data", na = "*") |> 
  janitor::clean_names()

readr::write_csv(
  english_education,
  fs::path(working_dir, "english_education.csv"))
```

```{r}


#transforming to log odds
#english_education <- english_education %>%
#  mutate(log_odds_ks4asy = log(key_stage_4_attainment_school_year_2012_to_2013 / (1 #- key_stage_4_attainment_school_year_2012_to_2013)))

#m1 <- lm(education_score ~ population_2011, data = english_education)

#summary(m1)

#m1 <- lm(education_score ~  factor(size_flag), data = english_education)

#summary(m1)

#better option - population_2011
#m1 <- lm(education_score ~  factor(size_flag)+factor(university_flag)+factor###(job_density_flag)+highest_level_qualification_achieved_b_age_22_average_score+factor(rgn11nm), data = english_education)
#summary(m1)


m1 <- lm(education_score ~  population_2011+highest_level_qualification_achieved_b_age_22_average_score+ level_3_at_age_18	+ activity_at_age_19_employment_with_earnings_above_10_000	, data = english_education)
summary(m1)


#ggplot(m1, aes(x = .fitted, y = .resid)) + 
  #geom_point() + 
  #geom_hline(yintercept = 0, color = "darkred") + 
  #labs(x = "Fitted (predicted) value", y = "Residual") + 
  #theme_bw()

#m2 <- lm(education_score ~ highest_level_qualification_achieved_b_age_22_average_score, data = english_education)

#summary(m2)
#transforming back
#predicted_log_odds <- predict(m1, type = "response")
#predicted_proportions <- exp(predicted_log_odds) / (1 + exp(predicted_log_odds))
```
